define(["app"],function(app){app.config(["$httpProvider",function($httpProvider){function modalAlert(message){$(".http-modal, .http-modal-backdrop").off().remove();var $modal=$('<div tabindex="-1" class="http-modal modal fade ngAlert in" ng-class="{in: animate}" style="z-index: 1050; display: block;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header">\r\n    <a href="javascript:void(0)" class="modal-close"></a>\r\n    <h3 class="modal-title">错误信息</h3>\r\n</div>\r\n<div class="modal-body">'+message+'</div>\r\n<div class="modal-footer">\r\n    <button class="btn btn-primary">确定</button>\r\n</div></div></div></div>'),$backdrop=$('<div class="modal-backdrop http-modal-backdrop in" style="z-index: 1040;"></div>');$modal.appendTo($("body")),$backdrop.appendTo($("body")),$modal.fadeIn(500),$modal.on("click",".modal-close, .btn-primary",function(){$modal.off().remove(),$backdrop.remove()})}var errorInterceptor=["$q","$log","$location",function($q,$log){return{request:function(config){return"GET"!==config.method||!config.url||/^template\//.test(config.url)||/^uib\/template\//.test(config.url)||(config.params=config.params||{},config.params._=/\.js$|\.html$/.test(config.url)?jrVersionStr:(new Date).getTime()),config},response:function(response){if("object"!=typeof response.data||response.data.success!==!1)return response;if("-300"===response.data.resCode)location.href="/manage/login";else{if("-400"!==response.data.resCode)return"-200"===response.data.resCode?$q.reject(response):($log.error(response),modalAlert(response.data.message),$q.reject(response));window.location.reload()}},responseError:function(rejection){$log.error(rejection);var syserror=(rejection.statusText,"系统错误，请稍后再试！");return modalAlert(syserror),$q.reject(rejection)}}}];$httpProvider.interceptors.push(errorInterceptor)}])});