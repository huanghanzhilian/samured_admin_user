define(["app"],function(app){app.registerDirective("uiDatepicker",["$filter",function($filter){return{restrict:"E",replace:!0,template:'<span class="datepicker ui-datepicker clearfix" ng-click="datepicker($event)">\r\n    <span ng-if="prefix" class="input-group-addon">{{prefix}}:</span>\r\n    <input type="text" uib-datepicker-popup="{{datepickerFormat}}" datepicker-options="options" ng-click="" is-open="opened" show-button-bar="showButton" close-on-date-selection="true" on-open-focus="false" ng-model="_time" is-open="opened" readonly />\r\n    <i></i>\r\n</span>',scope:{prefix:"@",format:"@",time:"=",options:"=",showButton:"@"},link:function($scope,iElement,iAttrs){var $input=iElement.find("input");return iAttrs.readonly?($input.attr("readonly",iAttrs.readonly),void $input.attr("disabled",!0)):($scope.datepickerFormat=$scope.format||"yyyy-MM-dd",$scope._time="string"==typeof $scope.time?new Date($scope.time.replace(/-/g,"/")):$scope.time,$scope.opened=!1,$scope.datepicker=function($event){($($event.target).hasClass("datepicker")||$($event.target).parent().hasClass("datepicker"))&&($scope.opened=!$scope.opened,$event.stopPropagation())},void $scope.$watch("_time",function(){$scope.time=$filter("date")($scope._time,$scope.datepickerFormat)}))}}}])});